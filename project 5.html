<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Movie & Series Finder</title>

  <!-- üåü Aesthetic UI + Invisible Scrollbar -->
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #141414;
      color: #fff;
      overflow-x: hidden;
      transition: background 0.3s, color 0.3s;
    }
    body.light-mode {
      background: #f0f0f0;
      color: #111;
    }

    /* Scrollbar Hidden */
    ::-webkit-scrollbar { display: none; }
    .top-carousel { -ms-overflow-style: none; scrollbar-width: none; }

    /* Theme Toggle */
    /* Improved Theme Toggle with Icons */
.theme-toggle input {
  width: 50px;
  height: 25px;
  -webkit-appearance: none;
  background: #333;
  border-radius: 25px;
  position: relative;
  cursor: pointer;
  outline: none;
}
.theme-toggle input::before {
  content: 'üåô';
  position: absolute;
  left: 5px;
  top: 2px;
  font-size: 18px;
  transition: transform 0.3s, content 0.3s;
}
.theme-toggle input:checked::before {
  content: 'üåû';
  transform: translateX(22px);
}

/* Scrollable overlay for posters */
.movie .overlay,
.carousel-item .overlay {
  max-height: 120px;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: #666 transparent;
}
.movie .overlay::-webkit-scrollbar,
.carousel-item .overlay::-webkit-scrollbar {
  width: 6px;
}
.movie .overlay::-webkit-scrollbar-thumb,
.carousel-item .overlay::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 3px;
}
    /* Hero Banner */
    .video-banner {
      position: relative; width: 100%; height: 70vh; background: #000; overflow: hidden;
    }
    .video-banner iframe {
      position: absolute; top: 50%; left: 50%;
      width: 100vw; height: 100vh;
      transform: translate(-50%, -50%);
      pointer-events: none; z-index: 0;
    }
    .video-overlay {
      position: relative; z-index: 1;
      max-width: 600px; padding: 60px 40px;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.6), #141414);
      transition: opacity 0.3s;
    }
    .video-overlay h2 { margin: 0 0 10px; font-size: 2em; }
    .video-overlay p { margin: 5px 0; font-size: 1em; }

    .mute-toggle, #fullscreenBtn {
      position: absolute; z-index: 10;
      background: rgba(0, 0, 0, 0.6); color: #fff;
      border: none; cursor: pointer;
    }
    .mute-toggle {
      top: 15px; left: 15px;
      width: 40px; height: 40px;
      border-radius: 50%; font-size: 20px;
    }
    #fullscreenBtn {
      bottom: 20px; right: 20px;
      padding: 8px 12px; border-radius: 5px; font-size: 14px;
    }

    /* Carousel */
    .top-carousel-container {
      padding: 10px 30px; margin: 0 auto;
    }
    .top-carousel {
      display: flex; overflow-x: auto;
      gap: 15px; padding-bottom: 20px;
      scroll-behavior: smooth;
    }
    .carousel-item {
      flex: 0 0 auto;
      width: 200px; height: 300px;
      background: #000; border-radius: 10px;
      overflow: hidden; transition: transform 0.3s;
    }
    .carousel-item:hover { transform: scale(1.05); }
    .carousel-item img { width: 100%; height: 100%; object-fit: cover; }
    .carousel-item .overlay {
      position: absolute; bottom: 0; width: 100%;
      background: rgba(0, 0, 0, 0.8);
      padding: 10px; color: #fff; font-size: 0.9em;
      display: none;
    }
    .carousel-item:hover .overlay { display: block; }

    /* Aesthetic Search Bar */
    .container {
      max-width: 1200px; margin: 50px auto; padding: 0 20px; text-align: center;
    }
    .container input[type="text"] {
      width: 60%; max-width: 500px;
      padding: 12px 18px; font-size: 16px;
      border: none; border-radius: 30px;
      background-color: #1f1f1f; color: #fff;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    .container input::placeholder { color: #aaa; }
    .container input:focus {
      background-color: #2c2c2c;
      box-shadow: 0 0 0 2px #ff9800;
    }
    .container button {
      padding: 12px 20px;
      margin-left: 10px;
      border: none; border-radius: 30px;
      background: #ff9800; color: white;
      font-size: 16px; cursor: pointer;
    }
    .container button:hover { background-color: #e68900; }

    /* Movie Grid */
    .movie-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px; margin-top: 20px;
    }
    .movie {
      background: #222;
      border-radius: 10px;
      overflow: hidden; position: relative;
      cursor: pointer; transition: transform 0.3s;
    }
    .movie:hover { transform: scale(1.08); }
    .movie img {
      width: 100%; height: 225px; object-fit: cover;
    }
    .movie .overlay {
      position: absolute; bottom: 0; width: 100%;
      background: rgba(0, 0, 0, 0.8); padding: 10px;
      color: #fff; font-size: 0.9em; display: none;
    }
    .movie:hover .overlay { display: block; }
  </style>
</head>

<body>
  <!-- üåô Theme Toggle -->
  <div class="theme-toggle">
    <input type="checkbox" id="theme-switch" title="Toggle Theme" />
  </div>

  <!-- üé¨ Hero Trailer -->
  <div class="video-banner" id="video-banner">
    <button class="mute-toggle" onclick="toggleMute()" id="muteBtn">üîá</button>
    <div class="video-overlay" id="videoOverlay">
      <h2 id="banner-title">Loading...</h2>
      <p id="banner-overview">Please wait while we fetch the latest trending movie...</p>
    </div>
    <iframe id="banner-trailer" src="" frameborder="0" allow="autoplay; muted" allowfullscreen></iframe>
    <button id="fullscreenBtn">Fullscreen</button>
  </div>

  <!-- üèÜ Top 10 Picks -->
  <div class="top-carousel-container">
    <h2>Top 10 Picks</h2>
    <div class="top-carousel" id="top-carousel"></div>
  </div>

  <!-- üîç Search + Grids -->
  <div class="container">
    <h1>Movie & Series Finder</h1>
    <input type="text" id="search-input" placeholder="Search for a movie, series, or anime..." onkeypress="if(event.key === 'Enter') searchMovies()">
    <button type="button" onclick="searchMovies()">Search</button>

    <h2>Trending Movies</h2>
    <div id="trending" class="movie-grid"></div>

    <h2>Suggestions</h2>
    <div id="suggestions" class="movie-grid"></div>
  </div>
  <script>
  const TMDB_KEY = "90eb9eb2d9ab2334eb82ec41b314e5f0";
  const OMDB_KEY = "eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI5MGViOWViMmQ5YWIyMzM0ZWI4MmVjNDFiMzE0ZTVmMCIsIm5iZiI6MTc0MDM5MDcyOS4zOTIsInN1YiI6IjY3YmM0MTQ5ZTVmZDE4ZjdiNjQ2NDdiMiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.5779bIR6MLeBMJwqOgvuyrYefD5fDZmKqXQncmZ0zl4";

  const trailerEl = document.getElementById("banner-trailer");
  const muteBtn = document.getElementById("muteBtn");
  const videoOverlay = document.getElementById("videoOverlay");
  const fullscreenBtn = document.getElementById("fullscreenBtn");

  function toggleMute() {
    if (trailerEl.src.includes("mute=1")) {
      trailerEl.src = trailerEl.src.replace("mute=1", "mute=0");
      muteBtn.innerText = "üîä";
    } else {
      trailerEl.src = trailerEl.src.replace("mute=0", "mute=1");
      muteBtn.innerText = "üîá";
    }
  }

  document.getElementById("theme-switch").addEventListener("change", function () {
    document.body.classList.toggle("light-mode");
  });

  fullscreenBtn.onclick = () => {
    const iframe = document.getElementById("banner-trailer");
    if (iframe.requestFullscreen) iframe.requestFullscreen();
    else if (iframe.webkitRequestFullscreen) iframe.webkitRequestFullscreen();
    else if (iframe.msRequestFullscreen) iframe.msRequestFullscreen();
  };

  async function showTrailer(id, type = 'movie') {
    const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}/videos?api_key=${TMDB_KEY}`);
    const data = await res.json();
    const trailer = data.results.find(v => v.type === "Trailer" && v.site === "YouTube");
    if (trailer) {
      document.getElementById("banner-trailer").src = `https://www.youtube.com/embed/${trailer.key}?autoplay=1&mute=1&controls=0&loop=1&playlist=${trailer.key}`;
    }
  }

  async function fetchOMDbDetails(imdb_id) {
    const response = await fetch(`https://www.omdbapi.com/?i=${imdb_id}&apikey=${OMDB_KEY}`);
    return await response.json();
  }

  async function fetchMovies(url, containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    const response = await fetch(url);
    const data = await response.json();

    for (const movie of data.results.slice(0, 20)) {
      if (!movie.poster_path) continue;

      let imdbRating = movie.vote_average?.toFixed(1);
      let imdb_id = null;

      try {
        const detailsRes = await fetch(`https://api.themoviedb.org/3/movie/${movie.id}?api_key=${TMDB_KEY}`);
        const detailsData = await detailsRes.json();
        imdb_id = detailsData.imdb_id;

        if (imdb_id) {
          const omdbData = await fetchOMDbDetails(imdb_id);
          if (omdbData.imdbRating && omdbData.imdbRating !== "N/A") {
            imdbRating = omdbData.imdbRating;
          }
        }
      } catch (error) {
        console.error("Error fetching OMDb data", error);
      }

      const movieDiv = document.createElement('div');
      movieDiv.classList.add('movie');
      movieDiv.innerHTML = `
        <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title || movie.name}" onclick="showTrailer(${movie.id}, '${movie.media_type || 'movie'}')">
        <div class="overlay">
          <p>‚≠ê IMDb: ${imdbRating}</p>
          <p>${movie.overview}</p>
        </div>`;
      movieDiv.onclick = () => showTrailer(movie.id, movie.media_type || 'movie');
      container.appendChild(movieDiv);
    }
  }

  async function loadHeroBanner() {
    const res = await fetch(`https://api.themoviedb.org/3/trending/movie/week?api_key=${TMDB_KEY}`);
    const data = await res.json();
    const firstMovie = data.results[0];
    showTrailer(firstMovie.id);
    document.getElementById("banner-title").textContent = firstMovie.title;
    document.getElementById("banner-overview").textContent = firstMovie.overview;
  }

  async function loadTopCarousel() {
    const res = await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${TMDB_KEY}`);
    const data = await res.json();
    const top10 = data.results.slice(0, 10);
    const container = document.getElementById("top-carousel");
    container.innerHTML = '';

    for (const item of top10) {
      if (!item.poster_path) continue;

      let imdbRating = item.vote_average?.toFixed(1);
      try {
        const detailsRes = await fetch(`https://api.themoviedb.org/3/${item.media_type || 'movie'}/${item.id}?api_key=${TMDB_KEY}`);
        const detailsData = await detailsRes.json();
        const imdb_id = detailsData.imdb_id;

        if (imdb_id) {
          const omdbData = await fetchOMDbDetails(imdb_id);
          if (omdbData.imdbRating && omdbData.imdbRating !== "N/A") {
            imdbRating = omdbData.imdbRating;
          }
        }
      } catch (error) {
        console.error("Error fetching OMDb for carousel", error);
      }

      const div = document.createElement("div");
      div.classList.add("carousel-item");
      div.innerHTML = `
        <img src="https://image.tmdb.org/t/p/w500${item.poster_path}" alt="${item.title || item.name}">
        <div class="overlay">
          <p><strong>${item.title || item.name}</strong></p>
          <p><strong>‚≠ê IMDb:</strong> ${imdbRating}</p>
        </div>
      `;
      div.onclick = () => showTrailer(item.id, item.media_type || 'movie');
      container.appendChild(div);
    }
  }

  function searchMovies() {
    const query = document.getElementById('search-input').value.trim();
    if (!query) return;
    fetchMovies(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB_KEY}&query=${encodeURIComponent(query)}`, 'trending');
  }

  // üîÑ Initial Load
  fetchMovies(`https://api.themoviedb.org/3/trending/movie/week?api_key=${TMDB_KEY}`, 'trending');
  fetchMovies(`https://api.themoviedb.org/3/movie/top_rated?api_key=${TMDB_KEY}`, 'suggestions');
  loadHeroBanner();
  loadTopCarousel();
</script>
